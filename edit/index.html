---
layout: default
title: My Github YAML Editor Micro Tool Base
---

<script type="text/javascript">

    // Reset the cookie manually
    //Cookies.expire('token');

    var $oAuthToken = getUrlVar('token');
    var $yaml_store = "";

    // When you fork, make sure ad add your org / user and repo name to _config.yml
    var $org = '{{ site.github_user }}';
    var $repo = '{{ site.github_repo }}';

    if($oAuthToken !='')
      {

      // Setting a cookie value
      Cookies.set('token', $oAuthToken);

      // Set with expiration
      // Cookies.set('token', $oAuthToken, { expires: '01/01/2017' });

      }

    // Grab the token from cookie
    $oAuthToken = Cookies.get('token');

    if($oAuthToken!='')
      {
      // Setup the Github connection
      var github = new Github({token: $oAuthToken,auth: "oauth"});
      var repo = github.getRepo($org,$repo);

      // Le'ts try to just get the Github Repo tree
      repo.getTree('gh-pages?recursive=true', function(err, tree) {

        if(err == null && $oAuthToken != null)
          {

            $categories = new Array();
            $categories.push("API Design");
            // If no error we have access, read YAML store
            repo.read('gh-pages', '_data/topics.yaml', function(err, data) {
              $yaml_store = jsyaml.load(data);
              $.each($yaml_store, function($rowKey, $rowEntry) {
                  $added = $.inArray($rowEntry.category, $categories);
                  //console.log("Added: " + $added);
                  if($added==-1)
                    {
                    $categories.push($rowEntry.category);
                    }
                });
            });
            $categories.sort();
            console.log($categories);
            // If no error we have access, read YAML store
            repo.read('gh-pages', '_data/topics.yaml', function(err, data) {

              $yaml_store = jsyaml.load(data);

              $( "#editor" ).append( "<tr><td colspan='2'><hr style='padding: 0px; margin: 0px;'></td></tr>");

              $displayCategory = '';

              $.each($categories, function($catKey, $category) {

                $( "#editor" ).append( "<tr title='category' style='padding: 3px 0px 3px 0px;'><td align='left' colspan='2' style='font-weight: bold; font-size: 20px;'>" + $category + "</td></tr>" );

                $.each($yaml_store, function($rowKey, $rowEntry) {

                  $topic_category = $rowEntry.category;
                  $topic_name = $rowEntry.name;
                  $topic_description = $rowEntry.description;

                  if($topic_category == $category)
                    {
                    $( "#editor" ).append( "<tr id='" + $rowKey + "' title='entry' style='padding: 3px 0px 3px 0px;'><td align='right' style='width: 30%; font-size: 14px;'>" + $topic_name + ":</td><td><textarea name='" + $topic_name + "' id='" + $rowKey + "-value' style='width: 100%; height: 50px;'>'" + $rowKey + "-value'</textarea></td></tr>" );
                    $( "#editor" ).append( "<tr title='line'><td colspan='2'><hr style='padding: 0px; margin: 0px;'></td></tr>");
                    }
                  });
              });
            });
          }
        else
          {
          // If error we DO NOT have access
          alert('We have NO access to API & repo!');
          }

        });

      }

      function saveYAMLStore()
        {
          $('#editor tr').each(function (i, row) {
              $type = row.title;
              $id = row.id;
              if($type=='entry')
                {
                  $name = document.getElementById($id).dname
                  $value = document.getElementById($id+'-value').value;
                  console.log('writing: ' + $id);
                  $yaml_store[$id]['value'] = $value;
                }
              });

          $yaml_dump = jsyaml.dump($yaml_store);
          console.log($yaml_dump);

        }

</script>
<h1>My Github YAML Editor Micro Tool Base</h1>
<p align="center">YAML loaded from _data/topics.yaml for editing, <a href="/github-micro-tool-yaml/">view by going back to home page</a>.</p>
<table width="100%" border="0" cellpadding="3" id="editor"></table>
<center><input type="button" name="SaveYAML" value="Save API Stylebook Design Guide" onclick="saveYAMLStore();" /></center>
